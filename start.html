<!DOCTYPE html>
<html>
<head>
  <title>CTF Write-ups</title>
  <style>
    html, body {
      height: 100%;
    }
    body {
      background-color: black;
      color: lime;
      font-family: "Courier New", monospace;
      margin: 0;
      padding: 0;
      padding-bottom: 60px; /* Add padding to prevent content from hiding behind footer */
      min-height: 100vh;
    }
    header {
      background: #111;
      border-bottom: 3px double lime;
      text-align: center;
      padding: 20px;
    }
    header h1 {
      font-size: 36px;
      text-shadow: 0 0 10px lime;
    }
    .container {
      max-width: 800px;
      margin: 10px auto;
      padding: 15px;
      padding-bottom: 50px;
    }
    .post {
      border: 2px dashed lime;
      padding: 15px;
      margin-bottom: 20px;
      background: #111;
    }
    .post h2 {
      color: cyan;
      text-shadow: 0 0 5px cyan;
    }
    .post .meta {
      font-size: 12px;
      color: gray;
      margin-bottom: 10px;
    }
    code, pre {
      display: block;
      background: black;
      border: 1px solid lime;
      padding: 10px;
      color: lime;
      overflow-x: auto;
      white-space: pre-wrap;
    }
    footer {
      background: #111;
      border-top: 3px double lime;
      text-align: center;
      padding: 15px;
      font-size: 12px;
      color: gray;
      position: fixed; /* Changed to fixed positioning */
      bottom: 0; /* Stick to bottom of screen */
      left: 0; /* Align to left edge */
      right: 0; /* Align to right edge */
      width: 100%; /* Full width */
      z-index: 1000; /* Ensure it stays on top */
    }
    .marquee-container {
      overflow: hidden;
      white-space: nowrap;
      color: yellow;
      background: #222;
      border-top: 3px double lime;
      border-bottom: 3px double lime;
      padding: 10px;
      position: relative;
    }
    .marquee-content {
      display: inline-block;
      animation: scroll-left 60s linear infinite;
    }
    @keyframes scroll-left {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }
    .flag {
      color: orangered;
      font-size: 18px;
    }
    .image-container {
      text-align: center;
      margin: 15px 0;
    }
    .image-container img {
      max-height: 400px;
      width: auto;
      border: 1px solid lime;
      border-radius: 10px;
    }
    input {
        width: 604px;
        height: 20px;
        background: #444;
        border: 2px solid lime;
        font-size: 16px;
        
    }
    input:focus {
        outline: none;
    }
    input::placeholder {
        color: black;
    }
  </style>
</head>
<body>
  <header>
    <h1>CTF Write-ups</h1>
    <p><i>Aydon S Fauscett</i></p>
  </header>
  
  
  <div class="marquee-container">
    <div class="marquee-content">
      Access Granted :: Welcome to My CTF Write-ups :: Hack The Planet :: Hacking like it's 1999 :: 
      Rooted in 0.1337 seconds :: sudo make me a sandwich :: There is no patch for human stupidity :: 
      Got shell? :: Hack the Gibson :: rm -rf / --no-preserve-root :: I void warranties :: 
      Pwned by curiosity :: Welcome, cybernaut :: All your base are belong to us :: printf("Hello, world!"); :: 
      Keep calm and exploit on :: 1337 h4x0r zone :: Black-hat or No-hat :: metasploit up this joint :: 
      Where's my bitcoin? :: I bet you use Spectrum :: Access Granted :: Welcome to My CTF Write-ups :: 
      Hack The Planet :: Hacking like it's 1999 :: Rooted in 0.1337 seconds :: sudo make me a sandwich :: 
      There is no patch for human stupidity :: Got shell? :: Hack the Gibson :: rm -rf / --no-preserve-root :: 
      I void warranties :: Pwned by curiosity :: Welcome, cybernaut :: All your base are belong to us :: 
      printf("Hello, world!"); :: Keep calm and exploit on :: 1337 h4x0r zone :: Black-hat or No-hat :: 
      metasploit up this joint :: Where's my bitcoin? :: I bet you use Spectrum ::
    </div>
  </div>

  <div class="container">
    <div class="post">
        <p>Enter password: <input id="password" placeholder="Password"></p>
    </div>
  </div>

  <footer>
    2025 ACTFC Write-ups | Made with &lt;3 for my fellow script kiddies
  </footer>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
  <script>
    function hexToBytes(hex) {
        const bytes = [];
        for (let i = 0; i < hex.length; i += 2) {
            bytes.push(parseInt(hex.substr(i, 2), 16));
        }
        return new Uint8Array(bytes);
    }

    async function sha256Hash(data) {
        const hashBuffer = await crypto.subtle.digest("SHA-256", hexToBytes(data));
        return Array.from(new Uint8Array(hashBuffer))
            .map(b => b.toString(16).padStart(2, "0"))
            .join("");
    }

    function aes256DecryptHexToLatin1(hexCiphertext, key) {
        const keyParsed = CryptoJS.enc.Hex.parse(key);
        const ciphertextWordArray = CryptoJS.enc.Hex.parse(hexCiphertext);
        const decrypted = CryptoJS.AES.decrypt(
            { ciphertext: ciphertextWordArray },
            keyParsed,
            { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.Pkcs7 }
        );
        return decrypted.toString(CryptoJS.enc.Latin1);
    }

    function aes256DecryptHexToBytes(hexCiphertext, key) {
        const keyParsed = CryptoJS.enc.Hex.parse(key);
        const ciphertextWordArray = CryptoJS.enc.Hex.parse(hexCiphertext);
        const decrypted = CryptoJS.AES.decrypt(
            { ciphertext: ciphertextWordArray },
            keyParsed,
            { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.Pkcs7 }
        );
        // Convert Latin1 string to Uint8Array
        const latin1 = decrypted.toString(CryptoJS.enc.Latin1);
        const bytes = new Uint8Array(latin1.length);
        for (let i = 0; i < latin1.length; ++i) {
            bytes[i] = latin1.charCodeAt(i);
        }
        return bytes;
    }

    async function decryptAndShowImages(key) {
        // Find all images in the container
        const container = document.querySelector('.container');
        const imgTags = container.querySelectorAll('img');
        for (const imgTag of imgTags) {
            const image = imgTag.getAttribute('src');
            const filename = image.split('/').pop();
            let mimeType = "image/png";
            if (filename.endsWith(".jpg") || filename.endsWith(".jpeg")) {
                mimeType = "image/jpeg";
            }
            const imgLockedUrl = `extras/${sha256Hash(filename)}.locked`;
            try {
                const imgResponse = await fetch(imgLockedUrl);
                if (!imgResponse.ok) continue;
                const imgHex = await imgResponse.text();
                const imgBytes = aes256DecryptHexToBytes(imgHex, key);
                const blob = new Blob([imgBytes], { type: mimeType });
                const url = URL.createObjectURL(blob);
                imgTag.src = url;
            } catch (e) {
                // If fetch or decrypt fails, skip image
                continue;
            }
        }
    }

    document.getElementById('password').addEventListener('keypress', async function(e) {
      if (e.key === 'Enter') {
        var value = this.value;
        if (await sha256Hash(value) != "34b15827250643e289b7f873a630781a91edbbd5eb6fffcb550bed9b1234d9fd") {
            alert("Password incorrect.");
        } else {
            // Decrypt HTML
            const response = await fetch('write-ups.locked');
            const hexCiphertext = await response.text();
            const decrypted = aes256DecryptHexToLatin1(hexCiphertext, value);
            document.querySelector(".container").innerHTML = decrypted;

            // Decrypt and show images
            await decryptAndShowImages(value);
        }
      }
    });
  </script>
</body>
</html>